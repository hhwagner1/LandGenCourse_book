<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.5 Bonus: ‘sf’ and ‘terra’ | Landscape Genetic Data Analysis with R</title>
  <meta name="description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="5.5 Bonus: ‘sf’ and ‘terra’ | Landscape Genetic Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  <meta name="github-repo" content="hhwagner1/LandGenCourse_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.5 Bonus: ‘sf’ and ‘terra’ | Landscape Genetic Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  

<meta name="author" content="Editor: Helene Wagner (University of Toronto)" />


<meta name="date" content="2026-01-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-exercise-week-2.html"/>
<link rel="next" href="Week3.html"/>
<script src="libs/jquery-3.7.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.3/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-11.10.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-11.10.0/highlight.min.js"></script>
<script src="libs/profvis-binding-0.4.0/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Landscape Genetic Data Analysis with R</a></li>

<li class="divider"></li>
<li class="part"><span><b>Getting Started</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i><b>1.1</b> How to use this Book</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#book-structure"><i class="fa fa-check"></i>1. Book Structure</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#find-what-is-relevant-for-you"><i class="fa fa-check"></i>2. Find what is relevant for you</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#course-r-package-landgencourse"><i class="fa fa-check"></i>3. Course R package ‘LandGenCourse’</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="list-of-packages.html"><a href="list-of-packages.html"><i class="fa fa-check"></i><b>1.2</b> List of R Packages by Vignette</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="review-of-r-skills.html"><a href="review-of-r-skills.html"><i class="fa fa-check"></i><b>2</b> Review of R Skills</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>2.1</b> Basic R Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#overview"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-types"><i class="fa fa-check"></i>2. Data Types</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-containers"><i class="fa fa-check"></i>3. Data Containers</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#programming"><i class="fa fa-check"></i>4. Programming</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-graphics.html"><a href="r-graphics.html"><i class="fa fa-check"></i><b>2.2</b> R Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overview-1"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#univariate-plots"><i class="fa fa-check"></i>2. Univariate plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#bivariate-plots"><i class="fa fa-check"></i>3. Bivariate plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#advanced-plotting"><i class="fa fa-check"></i>4. Advanced plotting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>2.3</b> Further R resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="github-for-group-projects.html"><a href="github-for-group-projects.html"><i class="fa fa-check"></i><b>3</b> GitHub for Group Projects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>3.1</b> Why use GitHub?</a>
<ul>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#goals"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#version"><i class="fa fa-check"></i>2. Watch course video: Version Control 101</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#slides"><i class="fa fa-check"></i>3. Preview slides</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#next-steps"><i class="fa fa-check"></i>4. Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>3.2</b> Installation</a>
<ul>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#goals-1"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="3.2.1" data-path="install.html"><a href="install.html#how-to-get-github-and-gitkraken-for-free"><i class="fa fa-check"></i><b>3.2.1</b> 2. How to get GitHub and GitKraken for free</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#happygit"><i class="fa fa-check"></i>3. Happy Git with R</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#gitvideos"><i class="fa fa-check"></i>4. Video tutorials: installation</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#join"><i class="fa fa-check"></i>5. Joining your group’s project on GitHub</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#repo"><i class="fa fa-check"></i>6. Setting up a group repo</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#next-steps-1"><i class="fa fa-check"></i>7. Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>3.3</b> Workflows</a>
<ul>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#goals-2"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#step-by-step-tutorials"><i class="fa fa-check"></i>2. Step-by-step tutorials</a></li>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#further-resources"><i class="fa fa-check"></i>3. Further resources</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Basic Topics</b></span></li>
<li class="chapter" data-level="4" data-path="Week1.html"><a href="Week1.html"><i class="fa fa-check"></i><b>4</b> Lab 1: Importing Genetic Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="video_1.html"><a href="video_1.html"><i class="fa fa-check"></i><b>4.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_1.html"><a href="video_1.html#embedded-video"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_1.html"><a href="video_1.html#preview-slides"><i class="fa fa-check"></i>2. Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tutorial_1.html"><a href="tutorial_1.html"><i class="fa fa-check"></i><b>4.2</b> Interactive Tutorial 1</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_1.html"><a href="tutorial_1.html#list-of-r-commands-covered-this-week"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_1.html"><a href="tutorial_1.html#general-instructions"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="WE_1.html"><a href="WE_1.html"><i class="fa fa-check"></i><b>4.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#overview-of-worked-example"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#import-data-from-.csv-file"><i class="fa fa-check"></i>2. Import data from .csv file</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#create-genind-object"><i class="fa fa-check"></i>3. Create ‘genind’ Object</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#view-information-stored-in-genind-object"><i class="fa fa-check"></i>4. View information stored in ‘genind’ object</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#import-data-with-gstudio-package"><i class="fa fa-check"></i>5. Import data with ‘gstudio’ package</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#importing-snp-data"><i class="fa fa-check"></i>6. Importing SNP data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="r-exercise-week-1.html"><a href="r-exercise-week-1.html"><i class="fa fa-check"></i><b>4.4</b> R exercise Week 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Week2.html"><a href="Week2.html"><i class="fa fa-check"></i><b>5</b> Lab 2: Spatial Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="video_2.html"><a href="video_2.html"><i class="fa fa-check"></i><b>5.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_2.html"><a href="video_2.html#embedded-video-1"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_2.html"><a href="video_2.html#preview-slides-1"><i class="fa fa-check"></i>2. Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="tutorial_2.html"><a href="tutorial_2.html"><i class="fa fa-check"></i><b>5.2</b> Interactive Tutorial 2</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_2.html"><a href="tutorial_2.html#list-of-r-commands-covered-this-week-1"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_2.html"><a href="tutorial_2.html#general-instructions-1"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="WE_2.html"><a href="WE_2.html"><i class="fa fa-check"></i><b>5.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#overview-of-worked-example-1"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#import-site-data-from-.csv-file"><i class="fa fa-check"></i>2. Import site data from .csv file</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#display-raster-data-and-overlay-sampling-locations-extract-data"><i class="fa fa-check"></i>3. Display raster data and overlay sampling locations, extract data</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#calculate-landscape-metrics"><i class="fa fa-check"></i>4. Calculate landscape metrics</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#sample-landscape-metrics-within-buffer-around-sampling-locations"><i class="fa fa-check"></i>5. Sample landscape metrics within buffer around sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-exercise-week-2.html"><a href="r-exercise-week-2.html"><i class="fa fa-check"></i><b>5.4</b> R Exercise Week 2</a></li>
<li class="chapter" data-level="5.5" data-path="bonus_2a.html"><a href="bonus_2a.html"><i class="fa fa-check"></i><b>5.5</b> Bonus: ‘sf’ and ‘terra’</a>
<ul>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#overview-2"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#import-and-export-esri-shapefiles"><i class="fa fa-check"></i>2. Import and export ESRI shapefiles</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#compatibility-with-sp-and-raster-objects"><i class="fa fa-check"></i>3. Compatibility with <code>sp</code> and <code>raster</code> objects</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#plotting-spatial-data-with-tmap"><i class="fa fa-check"></i>4. Plotting spatial data with <code>tmap</code></a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#plot-a-categorical-map-with-predefined-color-scheme"><i class="fa fa-check"></i>5. Plot a categorical map with predefined color scheme</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Week3.html"><a href="Week3.html"><i class="fa fa-check"></i><b>6</b> Lab 3: Genetic Diversity</a>
<ul>
<li class="chapter" data-level="6.1" data-path="video_3.html"><a href="video_3.html"><i class="fa fa-check"></i><b>6.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#embedded-video-2"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#video-part-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#video-part-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#preview-slides-2"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tutorial_3.html"><a href="tutorial_3.html"><i class="fa fa-check"></i><b>6.2</b> Interactive Tutorial 3</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_3.html"><a href="tutorial_3.html#list-of-r-commands-covered-this-week-2"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_3.html"><a href="tutorial_3.html#general-instructions-2"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="WE_3.html"><a href="WE_3.html"><i class="fa fa-check"></i><b>6.3</b> Worked Example</a></li>
<li class="chapter" data-level="6.4" data-path="r-exercise-week-3.html"><a href="r-exercise-week-3.html"><i class="fa fa-check"></i><b>6.4</b> R Exercise Week 3</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Week4.html"><a href="Week4.html"><i class="fa fa-check"></i><b>7</b> Lab 4: Metapopulations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="video_4.html"><a href="video_4.html"><i class="fa fa-check"></i><b>7.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#embedded-video-3"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#video-part-1-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#video-part-2-1"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#preview-slides-3"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="tutorial_4.html"><a href="tutorial_4.html"><i class="fa fa-check"></i><b>7.2</b> Interactive Tutorial 4</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_4.html"><a href="tutorial_4.html#list-of-r-commands-covered-this-week-3"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_4.html"><a href="tutorial_4.html#general-instructions-3"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="WE_4.html"><a href="WE_4.html"><i class="fa fa-check"></i><b>7.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#overview-of-worked-example-3"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#spatial-distribution-of-genetic-structure"><i class="fa fa-check"></i>2. Spatial distribution of genetic structure</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#what-determines-genetic-differentiation-among-sites"><i class="fa fa-check"></i>3. What determines genetic differentiation among sites?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#what-determines-genetic-diversity"><i class="fa fa-check"></i>4. What determines genetic diversity?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#are-genetic-differentiation-and-diversity-related"><i class="fa fa-check"></i>5. Are genetic differentiation and diversity related?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#effect-of-recent-extinction-events"><i class="fa fa-check"></i>6. Effect of recent extinction events</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="r-exercise-week-4.html"><a href="r-exercise-week-4.html"><i class="fa fa-check"></i><b>7.4</b> R Exercise Week 4</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Week5.html"><a href="Week5.html"><i class="fa fa-check"></i><b>8</b> Lab 5: Spatial Statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="video_5.html"><a href="video_5.html"><i class="fa fa-check"></i><b>8.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_5.html"><a href="video_5.html#embedded-video-4"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_5.html"><a href="video_5.html#preview-slides-4"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tutorial_5.html"><a href="tutorial_5.html"><i class="fa fa-check"></i><b>8.2</b> Interactive Tutorial 5</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_5.html"><a href="tutorial_5.html#list-of-r-commands-covered-this-week-4"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_5.html"><a href="tutorial_5.html#general-instructions-4"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="WE_5.html"><a href="WE_5.html"><i class="fa fa-check"></i><b>8.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#overview-of-worked-example-4"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#data-import-and-manipulation"><i class="fa fa-check"></i>2. Data import and manipulation</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#calculate-genetic-distances"><i class="fa fa-check"></i>3. Calculate genetic distances</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#perform-a-mantel-test-to-test-for-ibd"><i class="fa fa-check"></i>4. Perform a Mantel test to test for IBD</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#create-mantel-correlogram-for-genetic-data"><i class="fa fa-check"></i>5. Create Mantel correlogram for genetic data</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#specify-spatial-weights-and-calculate-morans-i"><i class="fa fa-check"></i>6. Specify spatial weights and calculate Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="r-exercise-week-5.html"><a href="r-exercise-week-5.html"><i class="fa fa-check"></i><b>8.4</b> R Exercise Week 5</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Week6.html"><a href="Week6.html"><i class="fa fa-check"></i><b>9</b> Lab 6: Quantitative Genetics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="video_6.html"><a href="video_6.html"><i class="fa fa-check"></i><b>9.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#embedded-video-5"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#video-part-1-2"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#video-part-2-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#preview-slides-5"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="tutorial_6.html"><a href="tutorial_6.html"><i class="fa fa-check"></i><b>9.2</b> Interactive Tutorial 6</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_6.html"><a href="tutorial_6.html#list-of-r-commands-covered-this-week-5"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_6.html"><a href="tutorial_6.html#general-instructions-5"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="WE_6.html"><a href="WE_6.html"><i class="fa fa-check"></i><b>9.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#overview-of-worked-example-5"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment"><i class="fa fa-check"></i>2. Estimate genetic and non-genetic variance components from a common garden experiment</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#estimate-trait-heritability"><i class="fa fa-check"></i>3. Estimate trait heritability</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#compare-q_st-to-f_st-measured-from-snp-data"><i class="fa fa-check"></i>4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#assess-correlation-between-trait-and-environment"><i class="fa fa-check"></i>5. Assess correlation between trait and environment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-6.html"><a href="r-exercise-week-6.html"><i class="fa fa-check"></i>R Exercise Week 6</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Week7.html"><a href="Week7.html"><i class="fa fa-check"></i><b>10</b> Lab 7: Spatial Linear Models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="video_7.html"><a href="video_7.html"><i class="fa fa-check"></i><b>10.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#embedded-video-6"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#video-part-1-3"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#video-part-2-3"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#preview-slides-6"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tutorial_7.html"><a href="tutorial_7.html"><i class="fa fa-check"></i><b>10.2</b> Interactive Tutorial 7</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_7.html"><a href="tutorial_7.html#list-of-r-commands-covered-this-week-6"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_7.html"><a href="tutorial_7.html#general-instructions-6"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="WE_7.html"><a href="WE_7.html"><i class="fa fa-check"></i><b>10.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#overview-of-worked-example-6"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#explore-data-set"><i class="fa fa-check"></i>2. Explore data set</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#test-regression-residuals-for-spatial-autocorrelation"><i class="fa fa-check"></i>3. Test regression residuals for spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-models-with-spatially-correlated-error-gls-with-package-nlme"><i class="fa fa-check"></i>4. Fit models with spatially correlated error (GLS) with package ‘nlme’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-spatial-simultaneous-autoregressive-error-models-sar"><i class="fa fa-check"></i>5. Fit spatial simultaneous autoregressive error models (SAR)</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#spatial-filtering-with-mem-using-package-spmoran"><i class="fa fa-check"></i>6. Spatial filtering with MEM using package ‘spmoran’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-spatially-varying-coefficients-model-with-package-spmoran"><i class="fa fa-check"></i>7. Fit spatially varying coefficients model with package ‘spmoran’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#model-with-patchsize-and-ibr"><i class="fa fa-check"></i>Model with PatchSize and IBR</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#model-with-ibr-only"><i class="fa fa-check"></i>Model with IBR only</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#conclusions"><i class="fa fa-check"></i>8. Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="r-exercise-week-7.html"><a href="r-exercise-week-7.html"><i class="fa fa-check"></i><b>10.4</b> R Exercise Week 7</a></li>
<li class="chapter" data-level="10.5" data-path="bonus_7a.html"><a href="bonus_7a.html"><i class="fa fa-check"></i><b>10.5</b> Bonus: Si index</a>
<ul>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#overview-of-bonus-materials"><i class="fa fa-check"></i>1. Overview of Bonus Materials</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#import-ecological-distance-matrices"><i class="fa fa-check"></i>2. Import ecological distance matrices</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#optimize-the-scaling-parameter-alpha"><i class="fa fa-check"></i>3. Optimize the scaling parameter alpha</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#calculate-hanskis-index-si-with-source-patch-parameters"><i class="fa fa-check"></i>4. Calculate Hanski’s index Si with source patch parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Week8.html"><a href="Week8.html"><i class="fa fa-check"></i><b>11</b> Lab 8: Simulation Experiments</a>
<ul>
<li class="chapter" data-level="11.1" data-path="video_8.html"><a href="video_8.html"><i class="fa fa-check"></i><b>11.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#embedded-video-7"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#video-part-1-4"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#video-part-2-4"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#preview-slides-7"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="tutorial_8.html"><a href="tutorial_8.html"><i class="fa fa-check"></i><b>11.2</b> Interactive Tutorial 8</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_8.html"><a href="tutorial_8.html#list-of-r-commands-covered-this-week-7"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_8.html"><a href="tutorial_8.html#general-instructions-7"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="WE_8.html"><a href="WE_8.html"><i class="fa fa-check"></i><b>11.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#overview-of-worked-example-7"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#initialize-a-landscape"><i class="fa fa-check"></i>2. Initialize a landscape</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#define-simulation-parameters"><i class="fa fa-check"></i>3. Define simulation parameters</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#run-simulations-and-analyze-results"><i class="fa fa-check"></i>4. Run simulations and analyze results</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#run-simulator-using-a-previously-defined-parameter-set"><i class="fa fa-check"></i>5. Run simulator using a previously defined parameter set</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="r-exercise-week-8.html"><a href="r-exercise-week-8.html"><i class="fa fa-check"></i><b>11.4</b> R Exercise Week 8</a></li>
<li class="chapter" data-level="11.5" data-path="bonus_8a.html"><a href="bonus_8a.html"><i class="fa fa-check"></i><b>11.5</b> Bonus: Efficient R</a></li>
</ul></li>
<li class="part"><span><b>Advanced Topics</b></span></li>
<li class="chapter" data-level="12" data-path="Week9.html"><a href="Week9.html"><i class="fa fa-check"></i><b>12</b> Lab 9: Population Structure</a>
<ul>
<li class="chapter" data-level="12.1" data-path="WE_9.html"><a href="WE_9.html"><i class="fa fa-check"></i><b>12.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#overview-of-worked-example-8"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#simulated-data-2-island-model"><i class="fa fa-check"></i>2. Simulated data: 2-island model</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#simulated-data-2-island-model-with-admixture"><i class="fa fa-check"></i>3. Simulated data: 2-island model with admixture</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#empirical-data-threespine-sticklebacks"><i class="fa fa-check"></i>4. Empirical data: Threespine sticklebacks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Week11.html"><a href="Week11.html"><i class="fa fa-check"></i><b>13</b> Lab 11: Detecting Adaptation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="WE_11.html"><a href="WE_11.html"><i class="fa fa-check"></i><b>13.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#overview-of-worked-example-9"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#import-and-prepare-the-data"><i class="fa fa-check"></i>2. Import and prepare the data</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#latent-factor-mixed-models-lfmm-a-univariate-gea"><i class="fa fa-check"></i>3. Latent Factor Mixed Models (LFMM): a univariate GEA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#redundancy-analysis-rda-a-multivariate-gea"><i class="fa fa-check"></i>4. Redundancy Analysis (RDA): a multivariate GEA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#compare-lfmm-and-rda-candidates"><i class="fa fa-check"></i>5. Compare LFMM and RDA candidates</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#a-quick-note-on-controlling-for-population-structure-in-rda"><i class="fa fa-check"></i>6. A quick note on controlling for population structure in RDA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#references"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="Week12.html"><a href="Week12.html"><i class="fa fa-check"></i><b>14</b> Lab 12: Model Selection</a>
<ul>
<li class="chapter" data-level="14.1" data-path="WE_12.html"><a href="WE_12.html"><i class="fa fa-check"></i><b>14.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#overview-of-worked-example-10"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#fitting-candidate-models"><i class="fa fa-check"></i>2. Fitting candidate models</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#your-turn-to-test-additional-hypotheses"><i class="fa fa-check"></i>3. Your turn to test additional hypotheses!</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#nested-model-nmlpe-for-hierarchical-sampling-designs"><i class="fa fa-check"></i>4. Nested model (NMLPE) for hierarchical sampling designs</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#references-1"><i class="fa fa-check"></i>5. References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Landscape Genetic Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bonus_2a" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Bonus: ‘sf’ and ‘terra’<a href="bonus_2a.html#bonus_2a" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Helene Wagner</p>
<div id="overview-2" class="section level3 unnumbered hasAnchor">
<h3>1. Overview<a href="bonus_2a.html#overview-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This bonus vignette uses the packages <code>sf</code>, <code>terra</code>, and <code>tmap</code>, yet it can only scratch the surface. For a thorough introduction to geocomputation with R, see this excellent Gitbook: <a href="https://geocompr.robinlovelace.net/index.html" class="uri">https://geocompr.robinlovelace.net/index.html</a>.</p>
<div id="a.-goals-1" class="section level4 unnumbered hasAnchor">
<h4>a. Goals<a href="bonus_2a.html#a.-goals-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This bonus material expands the Worked Example to show:</p>
<ul>
<li>How to import and export ESRI shapefiles.</li>
<li>Compatibility with packages <code>sp</code> and <code>raster</code></li>
<li>How to create static and interactive maps with <code>tmap</code>.</li>
<li>How to plot a categorical raster with a predefined color scheme.</li>
</ul>
<p>Try modifying the code to import your own data!</p>
</div>
<div id="b.-required-r-packages" class="section level4 unnumbered hasAnchor">
<h4>b. Required R packages<a href="bonus_2a.html#b.-required-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="bonus_2a.html#cb446-1" tabindex="-1"></a><span class="fu">library</span>(LandGenCourse)</span>
<span id="cb446-2"><a href="bonus_2a.html#cb446-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb446-3"><a href="bonus_2a.html#cb446-3" tabindex="-1"></a><span class="fu">library</span>(GeNetIt)</span>
<span id="cb446-4"><a href="bonus_2a.html#cb446-4" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb446-5"><a href="bonus_2a.html#cb446-5" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb446-6"><a href="bonus_2a.html#cb446-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb446-7"><a href="bonus_2a.html#cb446-7" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb446-8"><a href="bonus_2a.html#cb446-8" tabindex="-1"></a><span class="fu">library</span>(here)</span></code></pre></div>
</div>
</div>
<div id="import-and-export-esri-shapefiles" class="section level3 unnumbered hasAnchor">
<h3>2. Import and export ESRI shapefiles<a href="bonus_2a.html#import-and-export-esri-shapefiles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ESRI shapefiles are a widely used data format for sharing geospatial vector data. With the package sf, they are easy to import and export. Here’ we will export Sites.sf to a shapefile and then import it again.</p>
<div id="a.-export-sf-object-to-shapefile" class="section level4 hasAnchor" number="5.5.0.1">
<h4><span class="header-section-number">5.5.0.1</span> a. Export ‘sf’ object to shapefile<a href="bonus_2a.html#a.-export-sf-object-to-shapefile" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The following code may produce a warning that column names were abbreviated. It writes the component files for the ESRI shapefile into the pre-existing folder <code>output</code> (the first line will create it if does not exist yet). Remember to remove the hashtags ‘#’ to un-comment the code before running it.</p>
<p>The argument <code>delete_dsn</code> specifies whether any existing file with the same name should be deleted first (i.e., overwritten).</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="bonus_2a.html#cb447-1" tabindex="-1"></a><span class="fu">data</span>(ralu.site)</span>
<span id="cb447-2"><a href="bonus_2a.html#cb447-2" tabindex="-1"></a><span class="co">#if(!dir.exists(here(&quot;output&quot;))) dir.create(here(&quot;output&quot;))</span></span>
<span id="cb447-3"><a href="bonus_2a.html#cb447-3" tabindex="-1"></a><span class="co">#dir.create(here(&quot;output/Sites&quot;))</span></span>
<span id="cb447-4"><a href="bonus_2a.html#cb447-4" tabindex="-1"></a><span class="co">#st_write(ralu.site, here(&quot;output/Sites/Sites.shp&quot;), delete_dsn = TRUE)</span></span></code></pre></div>
<p>Navigate to the <code>Sites</code> folder in the <code>output</code> folder (Files tab). You should now see four component files of the shapefile. These four files are required parts of the shapefile, always keep (or share) them together! Some shapefiles will have additional, optional component files.</p>
<ul>
<li>Sites.dbf</li>
<li>Sites.prj</li>
<li>Sites.shp</li>
<li>Sites.shx</li>
</ul>
</div>
<div id="b.-import-shapefile-to-sf-object" class="section level4 hasAnchor" number="5.5.0.2">
<h4><span class="header-section-number">5.5.0.2</span> b. Import shapefile to ‘sf’ object<a href="bonus_2a.html#b.-import-shapefile-to-sf-object" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Importing a shapefile is very easy with the function <code>st_read</code> from the <code>sf</code> package. While you only need to provide the path to the <code>.shp</code> file, the other files listed above must be in the same folder.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="bonus_2a.html#cb448-1" tabindex="-1"></a><span class="co">#Sites.sf_a &lt;- st_read(here(&quot;output/Sites/Sites.shp&quot;))</span></span>
<span id="cb448-2"><a href="bonus_2a.html#cb448-2" tabindex="-1"></a><span class="co">#Sites.sf_a </span></span></code></pre></div>
</div>
</div>
<div id="compatibility-with-sp-and-raster-objects" class="section level3 unnumbered hasAnchor">
<h3>3. Compatibility with <code>sp</code> and <code>raster</code> objects<a href="bonus_2a.html#compatibility-with-sp-and-raster-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The packages sf and terra recently replaced the older packages sp and raster. You may still encounter code that requires objects from these packages. Here we show how to convert between sf and sp, and between terra and raster. The conversion is easy, though please note that sp objects are S4 objects.</p>
<div id="a.-converting-between-sf-and-sp" class="section level4 hasAnchor" number="5.5.0.3">
<h4><span class="header-section-number">5.5.0.3</span> a. Converting between <code>sf</code> and <code>sp</code><a href="bonus_2a.html#a.-converting-between-sf-and-sp" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It is easy to convert an <code>sf</code> object into a <code>Spatial</code> object of package <code>sp</code>, using the function <code>as_Spatial</code> of the <code>sf</code> package. For point data, the resulting class will be a <code>SpatialPointsDataFrame</code>.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="bonus_2a.html#cb449-1" tabindex="-1"></a><span class="fu">data</span>(ralu.site)</span>
<span id="cb449-2"><a href="bonus_2a.html#cb449-2" tabindex="-1"></a>Sites.sp <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">as_Spatial</span>(ralu.site)</span>
<span id="cb449-3"><a href="bonus_2a.html#cb449-3" tabindex="-1"></a>Sites.sp</span></code></pre></div>
<pre><code>## class       : SpatialPointsDataFrame 
## features    : 31 
## extent      : 686908.5, 690890.1, 4994089, 5004435  (xmin, xmax, ymin, ymax)
## crs         : +proj=utm +zone=11 +datum=NAD83 +units=m +no_defs 
## variables   : 17
## names       :     SiteName,    Drainage,    Basin, Substrate,                                          NWI,  AREA_m2, PERI_m, Depth_m, TDS, FISH,  ACB,   AUC,  AUCV,  AUCC, AUF, ... 
## min values  : AirplaneLake,  ClearCreek, Birdbill,    Cobble,                                   Lacustrine,        0,      0,       0,   0,    0,    0,     0,     0,     0,   0, ... 
## max values  :  WelcomeLake, WilsonCreek,   TipTop,      Silt, Riverine_UpperPerennial_UnconsolidatedBottom, 353898.1, 4312.9,    24.3,  20,    1, 0.11, 0.817, 0.463, 0.817,   1, ...</code></pre>
<p>We can convert the <code>Spatial</code> object back to an <code>sf</code> object with the function <code>st_as_sf</code> of the <code>sf</code> package:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="bonus_2a.html#cb451-1" tabindex="-1"></a>Sites.sf_b <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(Sites.sp)</span>
<span id="cb451-2"><a href="bonus_2a.html#cb451-2" tabindex="-1"></a>Sites.sf_b</span></code></pre></div>
<pre><code>## Simple feature collection with 31 features and 17 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 686908.5 ymin: 4994089 xmax: 690890.1 ymax: 5004435
## Projected CRS: +proj=utm +zone=11 +datum=NAD83 +units=m +no_defs
## First 10 features:
##          SiteName        Drainage      Basin Substrate
## 1    AirplaneLake ShipIslandCreek Sheepeater      Silt
## 2  BachelorMeadow     WilsonCreek    Skyhigh      Silt
## 3  BarkingFoxLake  WaterfallCreek    Terrace      Silt
## 4    BirdbillLake      ClearCreek   Birdbill      Sand
## 5         BobLake     WilsonCreek     Harbor      Silt
## 6       CacheLake     WilsonCreek    Skyhigh      Silt
## 7         DoeLake     WilsonCreek    Skyhigh      Silt
## 8    EggWhiteLake     WilsonCreek    Skyhigh      Silt
## 9      ElenasLake ShipIslandCreek Sheepeater      Sand
## 10       FawnLake     WilsonCreek    Skyhigh      Silt
##                                NWI AREA_m2 PERI_m Depth_m  TDS FISH ACB   AUC
## 1                       Lacustrine 62582.2 1142.8   21.64  2.5    1   0 0.411
## 2  Riverine_Intermittent_Streambed   225.0   60.0    0.40  0.0    0   0 0.000
## 3                       Lacustrine 12000.0  435.0    5.00 13.8    1   0 0.300
## 4                       Lacustrine 12358.6  572.3    3.93  6.4    1   0 0.283
## 5                       Palustrine  4600.0  321.4    2.00 14.3    0   0 0.000
## 6                       Palustrine  2268.8  192.0    1.86 10.9    0   0 0.000
## 7                       Lacustrine 13034.9  463.2    6.03 10.0    1   0 0.415
## 8                       Palustrine  4544.5  291.9    3.30  2.4    0   0 0.000
## 9                       Palustrine     0.0    0.0    0.00  0.0    0   0 0.000
## 10                      Palustrine  3865.9  237.7    1.98  3.6    0   0 0.000
##     AUCV  AUCC   AUF AWOOD  AUFV                 geometry
## 1  0.000 0.411 0.063 0.063 0.464 POINT (688816.6 5003207)
## 2  0.000 0.000 1.000 0.000 0.000 POINT (688494.4 4999093)
## 3  0.000 0.300 0.700 0.000 0.000 POINT (687938.4 5000223)
## 4  0.000 0.283 0.717 0.000 0.000 POINT (689732.8 5002522)
## 5  0.000 0.000 0.500 0.000 0.500   POINT (690104 4999355)
## 6  0.000 0.000 0.556 0.093 0.352 POINT (688742.5 4997481)
## 7  0.171 0.585 0.341 0.000 0.073 POINT (688962.4 4996675)
## 8  0.047 0.047 0.686 0.209 0.058 POINT (688539.3 4998146)
## 9  0.000 0.000 0.000 0.000 0.000 POINT (688878.7 5004435)
## 10 0.000 0.000 1.000 0.000 0.000 POINT (688901.5 4996837)</code></pre>
</div>
<div id="b.-converting-between-terra-and-raster" class="section level4 hasAnchor" number="5.5.0.4">
<h4><span class="header-section-number">5.5.0.4</span> b. Converting between <code>terra</code> and <code>raster</code><a href="bonus_2a.html#b.-converting-between-terra-and-raster" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To convert a <code>SpatRaster</code> (<code>terra</code>) with multiple layers into <code>RasterStack</code> of the package <code>raster</code>, we use the function <code>stack</code> of the <code>raster</code> package:</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="bonus_2a.html#cb453-1" tabindex="-1"></a>RasterMaps <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/covariates.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;GeNetIt&quot;</span>))</span>
<span id="cb453-2"><a href="bonus_2a.html#cb453-2" tabindex="-1"></a></span>
<span id="cb453-3"><a href="bonus_2a.html#cb453-3" tabindex="-1"></a>RasterMaps.r <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">stack</span>(RasterMaps)</span>
<span id="cb453-4"><a href="bonus_2a.html#cb453-4" tabindex="-1"></a>RasterMaps.r </span></code></pre></div>
<pre><code>## class      : RasterStack 
## dimensions : 426, 358, 152508, 6  (nrow, ncol, ncell, nlayers)
## resolution : 30, 30  (x, y)
## extent     : 683282.5, 694022.5, 4992833, 5005613  (xmin, xmax, ymin, ymax)
## crs        : +proj=utm +zone=11 +datum=NAD83 +units=m +no_defs 
## names      :          cti,        err27,          ffp,          gsp,          hli,         nlcd 
## min values : 8.429851e-01, 3.906551e-02, 0.000000e+00, 2.270000e+02, 1.014000e+03, 1.100000e+01 
## max values :   23.7147598,    0.7637643,   51.0000000,  338.0696716, 9263.0000000,   95.0000000</code></pre>
<p>To convert a single layer into a <code>RasterLayer</code> of the package <code>raster</code>, we would use the function <code>raster</code>:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="bonus_2a.html#cb455-1" tabindex="-1"></a>nlcd.r <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">raster</span>(RasterMaps<span class="sc">$</span>nlcd)</span>
<span id="cb455-2"><a href="bonus_2a.html#cb455-2" tabindex="-1"></a>nlcd.r </span></code></pre></div>
<pre><code>## class      : RasterLayer 
## band       : 6  (of  6  bands)
## dimensions : 426, 358, 152508  (nrow, ncol, ncell)
## resolution : 30, 30  (x, y)
## extent     : 683282.5, 694022.5, 4992833, 5005613  (xmin, xmax, ymin, ymax)
## crs        : +proj=utm +zone=11 +datum=NAD83 +units=m +no_defs 
## source     : covariates.tif 
## names      : nlcd 
## values     : 11, 95  (min, max)</code></pre>
<p>To convert from a <code>RasterLayer</code> (package <code>raster</code>) to a SpatRaster (package <code>terra</code>), we use the function <code>rast</code> of the <code>terra</code> package:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="bonus_2a.html#cb457-1" tabindex="-1"></a>nlcd <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(nlcd.r)</span>
<span id="cb457-2"><a href="bonus_2a.html#cb457-2" tabindex="-1"></a>nlcd</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## size        : 426, 358, 1  (nrow, ncol, nlyr)
## resolution  : 30, 30  (x, y)
## extent      : 683282.5, 694022.5, 4992833, 5005613  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=11 +datum=NAD83 +units=m +no_defs 
## source      : covariates.tif 
## name        : nlcd 
## min value   :   11 
## max value   :   95</code></pre>
<p>We can use the same function to convert from a <code>RasterStack</code> (package <code>raster</code>) to a SpatRaster with multiple layers (package <code>terra</code>):</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="bonus_2a.html#cb459-1" tabindex="-1"></a>RasterMaps_b <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(RasterMaps.r)</span>
<span id="cb459-2"><a href="bonus_2a.html#cb459-2" tabindex="-1"></a>RasterMaps_b</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## size        : 426, 358, 6  (nrow, ncol, nlyr)
## resolution  : 30, 30  (x, y)
## extent      : 683282.5, 694022.5, 4992833, 5005613  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=11 +datum=NAD83 +units=m +no_defs 
## source      : covariates.tif 
## names       :        cti,      err27, ffp,      gsp,  hli, nlcd 
## min values  :  0.8429851, 0.03906551,   0, 227.0000, 1014,   11 
## max values  : 23.7147598, 0.76376426,  51, 338.0697, 9263,   95</code></pre>
</div>
</div>
<div id="plotting-spatial-data-with-tmap" class="section level3 unnumbered hasAnchor">
<h3>4. Plotting spatial data with <code>tmap</code><a href="bonus_2a.html#plotting-spatial-data-with-tmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-plot-geometry" class="section level4 unnumbered hasAnchor">
<h4>a. Plot geometry<a href="bonus_2a.html#a.-plot-geometry" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The package <code>sf</code> makes a clear distinction between the geometry information (spatial coordinates: where in space) and attribute information (what’s at these locations). Hence, when using the function <code>plot</code> with <code>sf</code> objects, we need to decide what we want to plot: geometry or attributes?</p>
<p>To plot the geometry, we use function <code>st_geometry</code> to extract the geometry information from the <code>sf</code> object:</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="bonus_2a.html#cb461-1" tabindex="-1"></a><span class="fu">data</span>(ralu.site)</span>
<span id="cb461-2"><a href="bonus_2a.html#cb461-2" tabindex="-1"></a>Sites.sf_c <span class="ot">&lt;-</span> ralu.site</span>
<span id="cb461-3"><a href="bonus_2a.html#cb461-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(Sites.sf_c))</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-126-1.png" alt="" width="672" /></p>
</div>
<div id="b.-plot-attributes-in-space" class="section level4 unnumbered hasAnchor">
<h4>b. Plot attributes in space<a href="bonus_2a.html#b.-plot-attributes-in-space" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If we don’t extract the geometry, then R will assume that we want to plot attribute data. The default is to plot the first ten attributes.</p>
<p>Here we set the point character <code>pch</code> to a filled circle, which is symbol #16. With <code>cex=2</code>, we define the symbol size.</p>
<p>For an overview of ‘pch’ symbol numbers, and colors, check: <a href="http://vis.supstat.com/2013/04/plotting-symbols-and-color-palettes/" class="uri">http://vis.supstat.com/2013/04/plotting-symbols-and-color-palettes/</a></p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="bonus_2a.html#cb462-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb462-2"><a href="bonus_2a.html#cb462-2" tabindex="-1"></a><span class="fu">plot</span>(Sites.sf_c, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning: plotting the first 10 out of 17 attributes; use max.plot = 17 to plot
## all</code></pre>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-127-1.png" alt="" width="672" /></p>
<p>This is pretty cool! Let’s have a closer look at two of the variables.</p>
<ul>
<li><code>Basin</code> (left): this is a factor, and each factor level is assigned a different color.</li>
<li><code>Depth_m</code> (right): this is a quantitative variable, and R automatically uses a color ramp (from blue to pink to orange) to indicate variation in the values.</li>
</ul>
<p>Note: To learn about options for the <code>plot</code> function for <code>sf</code> objects, access the help file by typing <code>?plot</code> and select ‘Plot sf object’.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="bonus_2a.html#cb464-1" tabindex="-1"></a><span class="fu">plot</span>(Sites.sf_c[,<span class="fu">c</span>(<span class="st">&quot;Basin&quot;</span>, <span class="st">&quot;Depth_m&quot;</span>)], <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-128-1.png" alt="" width="672" /></p>
</div>
<div id="c.-create-a-static-bubble-plot-with-tmap" class="section level4 unnumbered hasAnchor">
<h4>c. Create a static bubble plot with ‘tmap’<a href="bonus_2a.html#c.-create-a-static-bubble-plot-with-tmap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>tmap</code> package (for plotting thematic maps) is a great tool for plotting maps. It is based on the grammar of graphics concepts, which take a bit of getting used to. Most importantly, we need the following parts:</p>
<ul>
<li><code>tmap_mode("plot")</code>: to plot a static map (default)</li>
<li><code>tm_shape</code>: this function defines the data to be used.</li>
<li><code>tm_sf</code>: this function defines what information should be plotted and how.</li>
</ul>
<p>Note: for the second part, there are many other functions for various types of data.</p>
<p>If we use <code>tm_sf</code> without arguments (i.e., with the default settings), we get a plot of the geometry:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="bonus_2a.html#cb465-1" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb465-2"><a href="bonus_2a.html#cb465-2" tabindex="-1"></a><span class="fu">tm_shape</span>(Sites.sf_c) <span class="sc">+</span> <span class="fu">tm_sf</span>()</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-129-1.png" alt="" width="672" /></p>
<p>We can indicate an attribute to plot it. Also, there is a special function <code>tm_bubbles</code> for bubble plots. Here we define the bubble size by wetland depth and bubble color by basin. In addition, we specify that the legend should be placed outside of the plot, on the right.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="bonus_2a.html#cb466-1" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb466-2"><a href="bonus_2a.html#cb466-2" tabindex="-1"></a><span class="fu">tm_shape</span>(Sites.sf_c) <span class="sc">+</span> <span class="fu">tm_bubbles</span>(<span class="at">size=</span><span class="st">&quot;Depth_m&quot;</span>, <span class="at">col=</span><span class="st">&quot;Basin&quot;</span>) <span class="sc">+</span></span>
<span id="cb466-3"><a href="bonus_2a.html#cb466-3" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>, <span class="at">legend.outside.position=</span><span class="st">&quot;right&quot;</span>) </span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-130-1.png" alt="" width="672" /></p>
<p>Let’s make the boundary box (map extent) a little larger so that the symbols are not cut off. First we extract the boundary box of <code>Sites.sf_c</code> and save it as <code>Bbox</code>.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="bonus_2a.html#cb467-1" tabindex="-1"></a>Bbox <span class="ot">=</span> <span class="fu">st_bbox</span>(Sites.sf_c)</span>
<span id="cb467-2"><a href="bonus_2a.html#cb467-2" tabindex="-1"></a>Bbox</span></code></pre></div>
<pre><code>##      xmin      ymin      xmax      ymax 
##  686908.5 4994089.3  690890.1 5004435.0</code></pre>
<p>Then we define the range along x and y coordinates (<code>delta.x</code>, <code>delta.y</code>), set a zoom factor (<code>Zoom</code>) and add that fraction of the range on each side. Unfortunately, there is no dedicated function for this so we do this manually:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="bonus_2a.html#cb469-1" tabindex="-1"></a>delta.x <span class="ot">&lt;-</span> Bbox[<span class="dv">3</span>] <span class="sc">-</span> Bbox[<span class="dv">1</span>]</span>
<span id="cb469-2"><a href="bonus_2a.html#cb469-2" tabindex="-1"></a>delta.y <span class="ot">&lt;-</span> Bbox[<span class="dv">4</span>] <span class="sc">-</span> Bbox[<span class="dv">2</span>]</span>
<span id="cb469-3"><a href="bonus_2a.html#cb469-3" tabindex="-1"></a>Zoom <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb469-4"><a href="bonus_2a.html#cb469-4" tabindex="-1"></a>Bbox2 <span class="ot">&lt;-</span> Bbox <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>delta.x, <span class="sc">-</span>delta.y, delta.x, delta.y) <span class="sc">*</span> Zoom</span>
<span id="cb469-5"><a href="bonus_2a.html#cb469-5" tabindex="-1"></a>Bbox2</span></code></pre></div>
<pre><code>##      xmin      ymin      xmax      ymax 
##  686510.4 4993054.7  691288.2 5005469.6</code></pre>
<p>Now we add the boundary box information as an argument <code>bbox</code> in function <code>tm_shape</code>.</p>
<p>Note that we write the figure into an object, <code>Map1</code>, then plot the <code>Map1</code>. This will help e.g. with exporting the map, or we can later add more layers to this map object with <code>+</code>.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="bonus_2a.html#cb471-1" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb471-2"><a href="bonus_2a.html#cb471-2" tabindex="-1"></a>Map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Sites.sf_c, <span class="at">bbox=</span>Bbox2) <span class="sc">+</span> </span>
<span id="cb471-3"><a href="bonus_2a.html#cb471-3" tabindex="-1"></a>  <span class="fu">tm_bubbles</span>(<span class="at">size=</span><span class="st">&quot;Depth_m&quot;</span>, <span class="at">col=</span><span class="st">&quot;Basin&quot;</span>) <span class="sc">+</span></span>
<span id="cb471-4"><a href="bonus_2a.html#cb471-4" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>, <span class="at">legend.outside.position=</span><span class="st">&quot;right&quot;</span>) </span>
<span id="cb471-5"><a href="bonus_2a.html#cb471-5" tabindex="-1"></a>Map1</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-133-1.png" alt="" width="672" /></p>
</div>
<div id="d.-create-an-interactive-bubble-plot-with-tmap" class="section level4 unnumbered hasAnchor">
<h4>d. Create an interactive bubble plot with ‘tmap’<a href="bonus_2a.html#d.-create-an-interactive-bubble-plot-with-tmap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Creating an interactive map with a basemap from the internet is not difficult. Un-comment the code below by removing the hashtag (#) and run it. Go ahead and play with the interactive map!</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="bonus_2a.html#cb472-1" tabindex="-1"></a><span class="co">#tmap_mode(&quot;view&quot;)</span></span>
<span id="cb472-2"><a href="bonus_2a.html#cb472-2" tabindex="-1"></a><span class="co">#tm_shape(Sites.sf_c) + tm_bubbles(size=&quot;Depth_m&quot;, col=&quot;Basin&quot;) </span></span></code></pre></div>
<p>By default, R will include an interactive menu to toggle between “Esri.WorldGrayCanvas”, “OpenStreetMap”, and “Esri.WorldTopoMap”. We can add more base maps to this selection by providing a list of servers with the function <code>tm_basemap</code>. The first one listed will be shown by default.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="bonus_2a.html#cb473-1" tabindex="-1"></a><span class="co">#tm_shape(Sites.sf_c) + tm_bubbles(size=&quot;Depth_m&quot;, col=&quot;Basin&quot;) +</span></span>
<span id="cb473-2"><a href="bonus_2a.html#cb473-2" tabindex="-1"></a><span class="co">#tm_basemap(server = c(&quot;Esri.WorldTopoMap&quot;, &quot;Esri.WorldGrayCanvas&quot;, </span></span>
<span id="cb473-3"><a href="bonus_2a.html#cb473-3" tabindex="-1"></a><span class="co">#                        &quot;OpenStreetMap&quot;, &quot;OpenTopoMap&quot;, &quot;Esri.WorldImagery&quot;))</span></span></code></pre></div>
<p>Let’s make a few more changes:</p>
<ul>
<li>We change the symbolization to fixed-size, filled circles with a black border, and plot them on top of filled circles that indicate the basin. Note that although both attributes are in the same dataset <code>Sites.sf_c</code>, we need to include a data statement for each attribute we add to the map (i.e., map layer), using <code>tm_shape(Sites.sf)</code>.</li>
<li>We include the argument <code>bbox=Bbox2</code> for at least one of the map layers. This is not needed for the interactive map but will look better when exporting it as a static map.</li>
</ul>
<p>Un-comment the code below by removing the hashtag (#) and run it. Go ahead and toggle between the base maps in the map below! Different base maps are suitable for different situations (data type, symbol type, size of study area) and purposes.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="bonus_2a.html#cb474-1" tabindex="-1"></a><span class="co">#tmap_mode(&quot;view&quot;)</span></span>
<span id="cb474-2"><a href="bonus_2a.html#cb474-2" tabindex="-1"></a></span>
<span id="cb474-3"><a href="bonus_2a.html#cb474-3" tabindex="-1"></a><span class="co">#Map2 &lt;- tm_shape(Sites.sf_c, bbox=Bbox2) +  tm_sf(&quot;Basin&quot;, size=2, border.col=&quot;black&quot;) +</span></span>
<span id="cb474-4"><a href="bonus_2a.html#cb474-4" tabindex="-1"></a><span class="co">#  tm_shape(Sites.sf_c) + tm_sf(size=0.8, col=&quot;Depth_m&quot;, </span></span>
<span id="cb474-5"><a href="bonus_2a.html#cb474-5" tabindex="-1"></a><span class="co">#                             palette = &quot;Blues&quot;, border.col=&quot;black&quot;) +</span></span>
<span id="cb474-6"><a href="bonus_2a.html#cb474-6" tabindex="-1"></a><span class="co">#  tm_basemap(server = c(&quot;Esri.WorldTopoMap&quot;, &quot;Esri.WorldGrayCanvas&quot;, </span></span>
<span id="cb474-7"><a href="bonus_2a.html#cb474-7" tabindex="-1"></a><span class="co">#                        &quot;OpenStreetMap&quot;, &quot;OpenTopoMap&quot;, &quot;Esri.WorldImagery&quot;))</span></span>
<span id="cb474-8"><a href="bonus_2a.html#cb474-8" tabindex="-1"></a><span class="co">#Map2</span></span></code></pre></div>
</div>
<div id="e.-export-maps" class="section level4 unnumbered hasAnchor">
<h4>e. Export maps<a href="bonus_2a.html#e.-export-maps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Save the map to folder <code>output</code>:</p>
<ul>
<li>Remember to un-comment the code by removing the hashtags (#).</li>
<li>Interactive map saved to <code>html</code> file. This includes all the features of the interactive map <code>Map2</code>.</li>
<li>Static map saved to <code>png</code> file, with height = 7 inches. This drops the base map and retains only the symbolized data.</li>
</ul>
<p>Go ahead and check out the two files!</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="bonus_2a.html#cb475-1" tabindex="-1"></a><span class="co">#if(!dir.exists(here(&quot;output&quot;))) dir.create(here(&quot;output&quot;))</span></span>
<span id="cb475-2"><a href="bonus_2a.html#cb475-2" tabindex="-1"></a><span class="co">#tmap_save(Map1, here::here(&quot;output/StaticMap.png&quot;), height=7)</span></span>
<span id="cb475-3"><a href="bonus_2a.html#cb475-3" tabindex="-1"></a><span class="co">#tmap_save(Map2, here::here(&quot;output/InteractiveMap.html&quot;))</span></span></code></pre></div>
<p>Navigate to the folder <code>output</code> (Files tab) and check out the saved maps! For the dynamic map (Map2), select “open in a web browser”. You can share this file with others, who can open it in their browser and interact with the map without access to R or your data!</p>
</div>
</div>
<div id="plot-a-categorical-map-with-predefined-color-scheme" class="section level3 unnumbered hasAnchor">
<h3>5. Plot a categorical map with predefined color scheme<a href="bonus_2a.html#plot-a-categorical-map-with-predefined-color-scheme" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-define-the-raster-attribute-table" class="section level4 unnumbered hasAnchor">
<h4>a. Define the raster attribute table<a href="bonus_2a.html#a.-define-the-raster-attribute-table" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now to a more tricky topic. Recall that the last raster layer in the Worked Example, <code>nlcd</code>, contains categorical land cover data that are coded numerically. The <code>terra</code> package actually misinterpreted them as numeric data.</p>
<p>Let’s extract the categorical raster layer into a new object ‘NLCD’. We can use <code>as.factor</code> to tell R that this is a categorical raster layer.</p>
<p>Here, we save the (numerical) raster layer <code>nlcd</code> as categorical raster (factor) <code>NLCD</code>.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="bonus_2a.html#cb476-1" tabindex="-1"></a>RasterMaps <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/covariates.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;GeNetIt&quot;</span>))</span>
<span id="cb476-2"><a href="bonus_2a.html#cb476-2" tabindex="-1"></a>NLCD <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">as.factor</span>(RasterMaps<span class="sc">$</span>nlcd)</span></code></pre></div>
<p>What values occur in the raster? These are codes for cover types.</p>
<p>Here is a description of the cover types: <a href="https://www.mrlc.gov/data/legends/national-land-cover-database-2019-nlcd2019-legend" class="uri">https://www.mrlc.gov/data/legends/national-land-cover-database-2019-nlcd2019-legend</a></p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="bonus_2a.html#cb477-1" tabindex="-1"></a><span class="fu">levels</span>(NLCD)[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##   ID nlcd
## 1 11   11
## 2 12   12
## 3 31   31
## 4 42   42
## 5 52   52
## 6 71   71
## 7 90   90
## 8 95   95</code></pre>
<p>We will import a table with predefined colors (using hex color code) from the file <code>Colortable_LULC.csv</code> that is included with <code>LandGenCourse</code>.</p>
<p>This list has more entries (e.g., 21-24) than we need, because not all US land cover classes occur in the study area.</p>
<p>Check in the table below that the colors and cover types are stored as ‘character’. (Luckily, since R 4.0, this is the new default for function <code>read.csv</code>). If they were coded as factors that could lead to errors later on.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="bonus_2a.html#cb479-1" tabindex="-1"></a>ColTab <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Colortable_LULC.csv&quot;</span>, </span>
<span id="cb479-2"><a href="bonus_2a.html#cb479-2" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>), <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb479-3"><a href="bonus_2a.html#cb479-3" tabindex="-1"></a>ColTab</span></code></pre></div>
<pre><code>##    value   color                    attribute
## 1     11 #456DA8                   Open Water
## 2     12 #E6EEF9           Perennial Ice/Snow
## 3     21 #E1CBCD        Developed, Open Space
## 4     22 #DC9786     Developed, Low Intensity
## 5     23 #F40100  Developed, Medium Intensity
## 6     24 #B00206    Developed, High Intensity
## 7     31 #B2AEA3 Barren Land (Rock/Sand/Clay)
## 8     41 #6BA95C             Deciduous Forest
## 9     42 #16692E             Evergreen Forest
## 10    43 #B9CA8F                 Mixed Forest
## 11    51 #AD9439                  Dwarf Scrub
## 12    52 #D5B883                  Shrub/Scrub
## 13    71 #EDEFCA         Grassland/Herbaceous
## 14    72 #D3D27C             Sedge/Herbaceous
## 15    73 #A5CD53                      Lichens
## 16    74 #88B8A1                         Moss
## 17    81 #DED73E                  Pasture/Hay
## 18    82 #AD722C             Cultivated Crops
## 19    90 #BED8F6               Woody Wetlands
## 20    95 #6EA5C4 Emergent Herbaceous Wetlands</code></pre>
<p>We join this list with the list of factor levels of <code>NLCD</code> to create a raster attribute table (RAT). An RAT is a table that contains attributes for each distinct value in a raster.</p>
<ul>
<li>Use function <code>left_join</code> to extract the corresponding row from <code>ColTab</code> for each row in <code>Levels(NLCD)</code></li>
<li>Indicate which columns should be used to match the rows: <code>by=c("ID"="value")</code>. Note that <code>ID</code> is of type <code>numeric</code> whereas <code>nlcd</code> is <code>character</code>. As <code>value</code> is numeric, we match it with <code>ID</code>.</li>
<li>Copy the values from variable <code>attribute</code> to variable <code>nlcd</code></li>
<li>Select the variables that we will need.</li>
</ul>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="bonus_2a.html#cb481-1" tabindex="-1"></a>RAT <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">levels</span>(NLCD)[[<span class="dv">1</span>]], ColTab, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb481-2"><a href="bonus_2a.html#cb481-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nlcd=</span>attribute) <span class="sc">%&gt;%</span> </span>
<span id="cb481-3"><a href="bonus_2a.html#cb481-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID, nlcd, color)</span></code></pre></div>
<p>We replace the list of levels by the RAT:</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="bonus_2a.html#cb482-1" tabindex="-1"></a><span class="fu">levels</span>(NLCD) <span class="ot">&lt;-</span> RAT</span>
<span id="cb482-2"><a href="bonus_2a.html#cb482-2" tabindex="-1"></a>NLCD</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## size        : 426, 358, 1  (nrow, ncol, nlyr)
## resolution  : 30, 30  (x, y)
## extent      : 683282.5, 694022.5, 4992833, 5005613  (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83 / UTM zone 11N (EPSG:26911) 
## source      : covariates.tif 
## categories  : nlcd, color 
## name        :                         nlcd 
## min value   :                   Open Water 
## max value   : Emergent Herbaceous Wetlands</code></pre>
</div>
<div id="b.-plot-the-map-with-terraplot" class="section level4 hasAnchor" number="5.5.0.5">
<h4><span class="header-section-number">5.5.0.5</span> b. Plot the map with <code>terra::plot</code><a href="bonus_2a.html#b.-plot-the-map-with-terraplot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now we can plot the map with the predefined color palette, using the <code>plot</code> function for <code>SpatRaster</code> objects:</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="bonus_2a.html#cb484-1" tabindex="-1"></a><span class="fu">plot</span>(NLCD, <span class="at">col=</span>RAT<span class="sc">$</span>color)</span>
<span id="cb484-2"><a href="bonus_2a.html#cb484-2" tabindex="-1"></a><span class="fu">points</span>(Sites.sf_c, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-143-1.png" alt="" width="672" /></p>
</div>
<div id="c.-plot-the-map-with-tmap" class="section level4 hasAnchor" number="5.5.0.6">
<h4><span class="header-section-number">5.5.0.6</span> c. Plot the map with <code>tmap</code><a href="bonus_2a.html#c.-plot-the-map-with-tmap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>We first define the dataset with <code>tm_shape</code></li>
<li>With <code>tm_raster</code>, we tell <code>tmap</code> that we want to plot raster values
<ul>
<li><code>style="cat"</code> tells <code>tmap</code> to interpret values as categories</li>
<li><code>palette</code> defines the colors</li>
<li><code>labels</code> defines the labels to be used for the categories</li>
<li><code>title</code> defines the legend caption for the categories</li>
</ul></li>
<li>With tm_layout, we tell tmap where to place the legend (outside to the right of map)</li>
<li>With <code>tm_grid(lines=FALSE)</code> we tell <code>tmap</code> to show the coordinates along x and y axes but to suppress grid lines that would be drawn on top of the map (change it to TRUE to see the effect)</li>
</ul>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="bonus_2a.html#cb485-1" tabindex="-1"></a>Map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(NLCD) <span class="sc">+</span> </span>
<span id="cb485-2"><a href="bonus_2a.html#cb485-2" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">style=</span><span class="st">&quot;cat&quot;</span>, <span class="at">palette=</span>RAT<span class="sc">$</span>color, <span class="at">labels=</span>RAT<span class="sc">$</span>nlcd,</span>
<span id="cb485-3"><a href="bonus_2a.html#cb485-3" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Land cover&quot;</span>) <span class="sc">+</span></span>
<span id="cb485-4"><a href="bonus_2a.html#cb485-4" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>, <span class="at">legend.outside.position=</span><span class="st">&quot;right&quot;</span>) </span></code></pre></div>
<pre><code>## </code></pre>
<pre><code>## ── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
<pre><code>## [v3-&gt;v4] `tm_raster()`: instead of `style = &quot;cat&quot;`, use col.scale =
## `tm_scale_categorical()`.
## ℹ Migrate the argument(s) &#39;palette&#39; (rename to &#39;values&#39;), &#39;labels&#39; to
##   &#39;tm_scale_categorical(&lt;HERE&gt;)&#39;
## [v3-&gt;v4] `tm_raster()`: migrate the argument(s) related to the legend of the
## visual variable `col` namely &#39;title&#39; to &#39;col.legend = tm_legend(&lt;HERE&gt;)&#39;</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="bonus_2a.html#cb489-1" tabindex="-1"></a>Map3</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-144-1.png" alt="" width="672" /></p>
<p>Let’s beef it up a bit. We can do so by adding layers to <code>Map3</code>:</p>
<ul>
<li>To add an additional layer with the sampling sites to the map, we define the data for the layer with <code>tm_shape</code>.</li>
<li>We define how the points should be symbolized with <code>tm_symbols</code>.</li>
<li>We add a North arrow with <code>tm_compass</code> , using default settings.</li>
<li>We add a scale bar with <code>tm_scale_bar</code> and set the background to a semitransparent (<code>bg.alpha=0.5</code>) light gray (<code>bg.color="lightgray"</code>).</li>
</ul>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="bonus_2a.html#cb490-1" tabindex="-1"></a>Map4 <span class="ot">&lt;-</span> Map3 <span class="sc">+</span> <span class="fu">tm_shape</span>(Sites.sf_c) <span class="sc">+</span></span>
<span id="cb490-2"><a href="bonus_2a.html#cb490-2" tabindex="-1"></a>  <span class="fu">tm_symbols</span>(<span class="at">size=</span><span class="fl">0.4</span>, <span class="at">col=</span><span class="st">&quot;yellow&quot;</span>, <span class="at">border.col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb490-3"><a href="bonus_2a.html#cb490-3" tabindex="-1"></a>  <span class="fu">tm_compass</span>() <span class="sc">+</span> <span class="fu">tm_scale_bar</span>(<span class="at">bg.color=</span><span class="st">&quot;lightgray&quot;</span>, <span class="at">bg.alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## </code></pre>
<pre><code>## ── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
<pre><code>## [v3-&gt;v4] `symbols()`: use &#39;fill&#39; for the fill color of polygons/symbols
## (instead of &#39;col&#39;), and &#39;col&#39; for the outlines (instead of &#39;border.col&#39;).
## ! `tm_scale_bar()` is deprecated. Please use `tm_scalebar()` instead.
## This message is displayed once every 8 hours.</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="bonus_2a.html#cb494-1" tabindex="-1"></a>Map4</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-145-1.png" alt="" width="672" /></p>
<p>This time, we’ll export the map to a PDF file.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="bonus_2a.html#cb495-1" tabindex="-1"></a><span class="co">#if(!dir.exists(here(&quot;output&quot;))) dir.create(here(&quot;output&quot;))</span></span>
<span id="cb495-2"><a href="bonus_2a.html#cb495-2" tabindex="-1"></a><span class="co">#tmap_save(Map4, here::here(&quot;output/RasterMap.pdf&quot;), height=6, width=8)</span></span></code></pre></div>

</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="r-exercise-week-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Week3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": false
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
